// Generated by CoffeeScript 1.7.1
(function() {
  'use strict';
  var UsrAdmApp;

  UsrAdmApp = angular.module('UsrAdmApp', ['ngAnimate', 'ui.bootstrap']);

  UsrAdmApp.controller('UsrAdmCtrl', (function() {
    function _Class($scope, $http, $timeout) {
      this.$scope = $scope;
      this.$http = $http;
      this.$timeout = $timeout;
      this.show_form = true;
      this.show_ok = false;
      this.show_invalid = false;
      this.uploading = false;
      this.user = {
        name: username,
        token: token
      };
      this.alerts = [];
      return null;
    }

    _Class.prototype.closeAlert = function(index) {
      this.alerts.splice(index, 1);
      return null;
    };

    _Class.prototype.update = function(user) {
      this.uploading = true;
      this.$http.post("changePassword", user).success((function(_this) {
        return function(data, status, headers, config) {
          _this.uploading = false;
          if (data["errors"].length > 0) {
            _this.alerts = _this.alerts.concat(data["errors"]);
            if (data["can_retry"] === 0) {
              _this.show_form = false;
              _this.show_ok = false;
              _this.show_invalid = true;
            }
          } else {
            _this.show_form = false;
            _this.show_ok = true;
            _this.show_invalid = false;
          }
          return null;
        };
      })(this)).error((function(_this) {
        return function(data, status, headers, config) {
          _this.uploading = false;
          _this.alerts.push({
            type: "danger",
            msg: "Error during communication with server, you may try later"
          });
          return null;
        };
      })(this));
      return null;
    };

    return _Class;

  })());

}).call(this);
